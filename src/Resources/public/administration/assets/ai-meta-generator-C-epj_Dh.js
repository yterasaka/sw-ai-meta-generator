const{Application:i}=Shopware;class o{constructor(t,r){this.httpClient=t,this.loginService=r}generateMetadata(t){const r=this.getBasicHeaders();return this.httpClient.post("_action/ai-meta-generator/generate",t,{headers:r}).then(a=>a.data).catch(a=>{throw a})}getBasicHeaders(){return{Accept:"application/vnd.api+json",Authorization:`Bearer ${this.loginService.getToken()}`,"Content-Type":"application/json"}}}i.addServiceProvider("aiMetaGeneratorApiService",e=>{const t=i.getContainer("init");return new o(t.httpClient,e.loginService)});const s=`{% block sw_product_seo_form_keywords %} {% parent %} {% block sw_product_seo_form_ai_generator_button %} <div class="sw-field sw-field--default"> <div class="sw-field__label"> <label class="sw-field__label-text"> {{ $tc('sw-product.seoForm.generateMetadataLabel') }} </label> <sw-help-text :text="$tc('sw-product.seoForm.generateMetadataHelpText')"> </sw-help-text> </div> <div class="sw-field__content"> <sw-button variant="primary" size="small" :disabled="isGenerating || !canGenerateMetadata" :isLoading="isGenerating" @click="onGenerateMetadata"> {{ $tc('sw-product.seoForm.generateMetadata') }} </sw-button> </div> </div> {% endblock %} {% endblock %}`,{Component:n,Mixin:c}=Shopware;n.override("sw-product-seo-form",{template:s,inject:["aiMetaGeneratorApiService"],mixins:[c.getByName("notification")],data(){return{isGenerating:!1}},computed:{canGenerateMetadata(){return this.product&&this.product.name&&this.product.name.trim()!==""&&this.product.description&&this.product.description.trim()!==""}},methods:{async onGenerateMetadata(){if(!this.product){this.createNotificationError({message:this.$tc("sw-product.seoForm.errorProductNotFound")});return}if(!this.canGenerateMetadata){this.createNotificationError({message:this.$tc("sw-product.seoForm.errorMissingRequiredFields")});return}this.isGenerating=!0;try{const e=Shopware.Context.api.languageId,t={productId:this.product.id,productName:this.product.name,description:this.product.description,languageId:e},r=await this.aiMetaGeneratorApiService.generateMetadata(t);if(r.success)this.updateProductMetadata(r.data),this.createNotificationSuccess({message:this.$tc("sw-product.seoForm.metadataGeneratedSuccess")});else throw new Error(r.error||"Unknown error occurred")}catch(e){let t=e.message;e.response&&e.response.data&&e.response.data.error&&(t=e.response.data.error),this.createNotificationError({message:this.$tc("sw-product.seoForm.errorGeneratingMetadata")+": "+t})}finally{this.isGenerating=!1}},updateProductMetadata(e){if(!this.product){console.error("Product not found");return}e.metaTitle&&(this.product.metaTitle=e.metaTitle),e.metaDescription&&(this.product.metaDescription=e.metaDescription),e.keywords&&(this.product.keywords=e.keywords),this.$emit("product-changed")}}});
//# sourceMappingURL=ai-meta-generator-C-epj_Dh.js.map
